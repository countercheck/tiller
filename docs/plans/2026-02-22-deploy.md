# deploy/ Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Populate deploy/ with nginx config template, Breedbase sgn_local.conf template, configure.sh substitution script, backup.sh, and a full deployment RUNBOOK.

**Architecture:** T3 Breedbase is cloned separately on each client VM. This directory holds only what T3 doesn't provide. Config templates use `{{PLACEHOLDER}}` syntax; configure.sh substitutes them via sed. nginx runs on the host OS and proxies to the Breedbase web container on localhost:8082 (hordeum/barley instance).

**Tech Stack:** bash, nginx, Breedbase T3 (Perl/Catalyst + PostgreSQL 12 in Docker), certbot, Azure CLI

---

### Task 1: nginx config template

**Files:**
- Create: `deploy/nginx/breedbase.conf.template`

**Step 1: Create the template**

```nginx
# deploy/nginx/breedbase.conf.template
# Substitute {{CLIENT_HOSTNAME}} before installing to /etc/nginx/sites-available/

server {
    listen 80;
    server_name {{CLIENT_HOSTNAME}};

    # Redirect all HTTP to HTTPS
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name {{CLIENT_HOSTNAME}};

    ssl_certificate     /etc/letsencrypt/live/{{CLIENT_HOSTNAME}}/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/{{CLIENT_HOSTNAME}}/privkey.pem;
    include             /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam         /etc/letsencrypt/ssl-dhparams.pem;

    # Increase body size limit for file uploads (genomics data, images)
    client_max_body_size 500M;

    location / {
        proxy_pass         http://localhost:8082;
        proxy_http_version 1.1;
        proxy_set_header   Host              $host;
        proxy_set_header   X-Real-IP         $remote_addr;
        proxy_set_header   X-Forwarded-For   $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Proto $scheme;

        # Support long-running requests (trial analysis, large uploads)
        proxy_read_timeout 300s;
        proxy_send_timeout 300s;
    }
}
```

**Step 2: Verify the template has all expected placeholders**

```bash
grep -o '{{[A-Z_]*}}' deploy/nginx/breedbase.conf.template | sort -u
```

Expected output:
```
{{CLIENT_HOSTNAME}}
```

**Step 3: Commit**

```bash
git add deploy/nginx/breedbase.conf.template
git commit -m "feat: add nginx config template"
```

---

### Task 2: sgn_local.conf template

**Context:** This is the main Breedbase application config. Based on the T3 hordeum.conf
(barley). The `main_production_site_url` must match the public HTTPS URL. The `dbpass`
is the PostgreSQL password set during `./bin/breedbase setup`. Paths are fixed inside the
container and must not be changed.

**Files:**
- Create: `deploy/breedbase/sgn_local.conf.template`

**Step 1: Create the template**

```
# deploy/breedbase/sgn_local.conf.template
# Substitute all {{PLACEHOLDERS}} via configure.sh before copying into the T3 config/ dir.
# This configures the barley (hordeum) instance.
# For a triticale instance, copy this file and adjust trait_ontology_db_name,
# onto_root_namespaces, trait_cv_name, preferred_species, and dbname.

main_production_site_url  https://{{CLIENT_HOSTNAME}}

dbhost    breedbase_db
dbname    cxgn_hordeum
dbuser    web_usr
dbpass    {{DB_PASSWORD}}

contact_email    {{CONTACT_EMAIL}}

# SMTP — leave blank to disable email (acceptable for initial deployment)
smtp_server
smtp_port
smtp_login
smtp_pass
smtp_from
smtp_layer
smtp_auth

disable_add_user        0
disable_login           0
user_auto_submitter     0

# File submission paths (bind-mounted; do not change)
submission_path         /home/production/submissions
allow_trial_submissions 1
allow_file_submissions  0

# Barley Composite Ontology (CO_323) — pre-loaded in T3 fork
trait_ontology_db_name           CO_323
onto_root_namespaces             CO_323 (Barley Trait Ontology), GO (Gene Ontology), PO (Plant Ontology), SO (Sequence Ontology), PATO (Phenotype and Trait Ontology)
trait_cv_name                    barley_trait
trait_variable_onto_root_namespace  CO_323 (Barley Trait Ontology), COMP (Composed Variables)
composable_cvs                   trait,toy
composable_cvs_allowed_combinations Time Series|trait+toy
composable_toy_root_cvterm       "time of year|TIME:0000005"

editable_stock_props             variety,country of origin,notes,accession number,PUI,organization,purdy pedigree,filial generation

preferred_species    Hordeum
identifier_prefix    CB
project_name         {{CLIENT_NAME}}

# Fixed internal paths (do not change — match Docker bind mounts in T3 docker-compose.yml)
rootpath          /home/production/cxgn
basepath          /home/production/cxgn/sgn
www_user          www-data
www_group         www-data
production_server 1
image_dir         /images/image_files_hordeum
image_path        /home/production/public/images/image_files_hordeum
cluster_shared_tempdir  /home/production/tmp
tempfiles_base          /home/production/tmp/hordeum-site
static_datasets_path    /home/production/public
static_content_url      /static_content
static_content_path     /home/production/cxgn/hordeum/static_content
homepage_files_dir      /home/production/cxgn/hordeum/static_content
trial_download_logfile  /home/production/logs/hordeum
archive_path            /home/production/archive
submit_dir              /home/production/public/submit-uploads
blast_path              ""
blast_db_path           /home/production/cxgn_blast_databases
solgs_dir               /home/production/tmp/solgs/__USERNAME__

synonym_search_tool_host  https://synonyms.triticeaetoolbox.org

<Controller::Cview>
  cview_default_map_id  25
</Controller::Cview>

<View::Mason>
  add_comp_root  /home/production/cxgn/hordeum/mason
</View::Mason>
```

**Step 2: Verify all placeholders are present**

```bash
grep -o '{{[A-Z_]*}}' deploy/breedbase/sgn_local.conf.template | sort -u
```

Expected output:
```
{{CLIENT_NAME}}
{{CONTACT_EMAIL}}
{{DB_PASSWORD}}
{{CLIENT_HOSTNAME}}
```

**Step 3: Commit**

```bash
git add deploy/breedbase/sgn_local.conf.template
git commit -m "feat: add sgn_local.conf template for barley instance"
```

---

### Task 3: configure.sh with tests

**Files:**
- Create: `deploy/scripts/tests/test_configure.sh`
- Create: `deploy/scripts/configure.sh`

**Step 1: Write the failing test first**

```bash
#!/usr/bin/env bash
# deploy/scripts/tests/test_configure.sh
# Run from repo root: bash deploy/scripts/tests/test_configure.sh
set -euo pipefail

CONFIGURE="deploy/scripts/configure.sh"
WORKDIR=$(mktemp -d)
trap "rm -rf $WORKDIR" EXIT

pass=0
fail=0

assert_contains() {
    local label="$1" pattern="$2" file="$3"
    if grep -q "$pattern" "$file"; then
        echo "  PASS: $label"
        ((pass++)) || true
    else
        echo "  FAIL: $label — expected '$pattern' not found"
        echo "  File contents:"
        cat "$file" | sed 's/^/    /'
        ((fail++)) || true
    fi
}

assert_not_contains() {
    local label="$1" pattern="$2" file="$3"
    if ! grep -q "$pattern" "$file"; then
        echo "  PASS: $label"
        ((pass++)) || true
    else
        echo "  FAIL: $label — '$pattern' should not be present"
        ((fail++)) || true
    fi
}

echo "--- Test: all placeholders are substituted ---"

cat > "$WORKDIR/test.template" <<'TMPL'
host={{CLIENT_HOSTNAME}}
name={{CLIENT_NAME}}
pass={{DB_PASSWORD}}
prog={{PROGRAM_NAME}}
email={{CONTACT_EMAIL}}
stor={{AZURE_STORAGE_ACCOUNT}}
cont={{AZURE_CONTAINER}}
TMPL

export CLIENT_HOSTNAME="test.example.com"
export CLIENT_NAME="testclient"
export DB_PASSWORD="secret123"
export PROGRAM_NAME="TEST_BARLEY"
export CONTACT_EMAIL="breeder@example.com"
export AZURE_STORAGE_ACCOUNT="teststore"
export AZURE_CONTAINER="test-backups"

bash "$CONFIGURE" "$WORKDIR/test.template" "$WORKDIR/test.output"

assert_contains     "CLIENT_HOSTNAME substituted"    "host=test.example.com"    "$WORKDIR/test.output"
assert_contains     "CLIENT_NAME substituted"        "name=testclient"          "$WORKDIR/test.output"
assert_contains     "DB_PASSWORD substituted"        "pass=secret123"           "$WORKDIR/test.output"
assert_contains     "PROGRAM_NAME substituted"       "prog=TEST_BARLEY"         "$WORKDIR/test.output"
assert_contains     "CONTACT_EMAIL substituted"      "email=breeder@example.com" "$WORKDIR/test.output"
assert_contains     "AZURE_STORAGE_ACCOUNT subst."   "stor=teststore"           "$WORKDIR/test.output"
assert_contains     "AZURE_CONTAINER substituted"    "cont=test-backups"        "$WORKDIR/test.output"
assert_not_contains "No unreplaced placeholders"     "{{"                       "$WORKDIR/test.output"

echo ""
echo "--- Test: missing required variable causes failure ---"

unset DB_PASSWORD
if bash "$CONFIGURE" "$WORKDIR/test.template" "$WORKDIR/test.output2" 2>/dev/null; then
    echo "  FAIL: should have exited non-zero with missing DB_PASSWORD"
    ((fail++)) || true
else
    echo "  PASS: exits non-zero when required variable is missing"
    ((pass++)) || true
fi

echo ""
echo "Results: $pass passed, $fail failed"
[[ $fail -eq 0 ]]
```

**Step 2: Run test — expect failure (configure.sh does not exist yet)**

```bash
bash deploy/scripts/tests/test_configure.sh
```

Expected: error — `deploy/scripts/configure.sh: No such file or directory`

**Step 3: Implement configure.sh**

```bash
#!/usr/bin/env bash
# deploy/scripts/configure.sh
# Substitutes {{PLACEHOLDER}} values in a template file.
#
# Usage:
#   configure.sh <source_template> <destination_file>
#
# Required environment variables:
#   CLIENT_HOSTNAME        e.g. edmonton.ourplatform.ca
#   CLIENT_NAME            e.g. edmonton
#   DB_PASSWORD            PostgreSQL password for web_usr
#   PROGRAM_NAME           e.g. AB_Barley
#   CONTACT_EMAIL          admin contact address
#   AZURE_STORAGE_ACCOUNT  Azure storage account name
#   AZURE_CONTAINER        Azure blob container name
set -euo pipefail

usage() {
    echo "Usage: $0 <source_template> <destination_file>" >&2
    exit 1
}

[[ $# -eq 2 ]] || usage

SRC="$1"
DST="$2"

[[ -f "$SRC" ]] || { echo "Error: template not found: $SRC" >&2; exit 1; }

# Verify all required variables are set (set -u catches unset vars, but give clear messages)
required_vars=(
    CLIENT_HOSTNAME
    CLIENT_NAME
    DB_PASSWORD
    PROGRAM_NAME
    CONTACT_EMAIL
    AZURE_STORAGE_ACCOUNT
    AZURE_CONTAINER
)

for var in "${required_vars[@]}"; do
    [[ -n "${!var:-}" ]] || { echo "Error: required variable $var is not set" >&2; exit 1; }
done

sed \
    -e "s|{{CLIENT_HOSTNAME}}|${CLIENT_HOSTNAME}|g" \
    -e "s|{{CLIENT_NAME}}|${CLIENT_NAME}|g" \
    -e "s|{{DB_PASSWORD}}|${DB_PASSWORD}|g" \
    -e "s|{{PROGRAM_NAME}}|${PROGRAM_NAME}|g" \
    -e "s|{{CONTACT_EMAIL}}|${CONTACT_EMAIL}|g" \
    -e "s|{{AZURE_STORAGE_ACCOUNT}}|${AZURE_STORAGE_ACCOUNT}|g" \
    -e "s|{{AZURE_CONTAINER}}|${AZURE_CONTAINER}|g" \
    "$SRC" > "$DST"

echo "Configured: $SRC → $DST"
```

Note: Uses `|` as sed delimiter instead of `/` so that hostnames (which contain `/` in URLs) don't break the substitution.

**Step 4: Make configure.sh executable**

```bash
chmod +x deploy/scripts/configure.sh
```

**Step 5: Run test — expect pass**

```bash
bash deploy/scripts/tests/test_configure.sh
```

Expected:
```
--- Test: all placeholders are substituted ---
  PASS: CLIENT_HOSTNAME substituted
  PASS: CLIENT_NAME substituted
  PASS: DB_PASSWORD substituted
  PASS: PROGRAM_NAME substituted
  PASS: CONTACT_EMAIL substituted
  PASS: AZURE_STORAGE_ACCOUNT subst.
  PASS: AZURE_CONTAINER substituted
  PASS: No unreplaced placeholders

--- Test: missing required variable causes failure ---
  PASS: exits non-zero when required variable is missing

Results: 9 passed, 0 failed
```

**Step 6: Commit**

```bash
git add deploy/scripts/configure.sh deploy/scripts/tests/test_configure.sh
git commit -m "feat: add configure.sh with placeholder substitution and tests"
```

---

### Task 4: backup.sh

**Context:** Runs as a weekly cron job on the VM. Dumps the PostgreSQL database from
the running breedbase_db container and uploads the compressed file to Azure Blob Storage.
Uses `az storage blob upload` with managed identity auth (no stored credentials).

**Files:**
- Create: `deploy/scripts/backup.sh`

**Step 1: Create backup.sh**

```bash
#!/usr/bin/env bash
# deploy/scripts/backup.sh
# Weekly database backup: pg_dump from breedbase_db container → Azure Blob Storage.
#
# Install as cron job (as root or user with Docker access):
#   0 2 * * 0  CLIENT_NAME=edmonton AZURE_STORAGE_ACCOUNT=tillerbackups \
#              AZURE_CONTAINER=edmonton-backups /path/to/backup.sh
#
# Required environment variables:
#   CLIENT_NAME            used in backup filename
#   AZURE_STORAGE_ACCOUNT  Azure storage account name
#   AZURE_CONTAINER        Azure blob container name
#
# Prerequisites:
#   - azure-cli installed and VM has Storage Blob Data Contributor role
#   - breedbase_db container is running
set -euo pipefail

: "${CLIENT_NAME:?CLIENT_NAME is required}"
: "${AZURE_STORAGE_ACCOUNT:?AZURE_STORAGE_ACCOUNT is required}"
: "${AZURE_CONTAINER:?AZURE_CONTAINER is required}"

TIMESTAMP=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="/tmp/breedbase_${CLIENT_NAME}_${TIMESTAMP}.sql.gz"
BLOB_NAME="breedbase_${CLIENT_NAME}_${TIMESTAMP}.sql.gz"

echo "[$(date)] Starting backup for client: ${CLIENT_NAME}"

# Dump database from running container
docker exec breedbase_db \
    pg_dump -U postgres cxgn_hordeum \
    | gzip > "$BACKUP_FILE"

echo "[$(date)] Dump complete: ${BACKUP_FILE}"

# Upload to Azure Blob Storage (uses VM managed identity — no stored credentials)
az storage blob upload \
    --account-name "${AZURE_STORAGE_ACCOUNT}" \
    --container-name "${AZURE_CONTAINER}" \
    --name "${BLOB_NAME}" \
    --file "${BACKUP_FILE}" \
    --auth-mode login \
    --output none

echo "[$(date)] Uploaded: ${BLOB_NAME}"

# Remove local dump
rm "${BACKUP_FILE}"

echo "[$(date)] Backup complete"
```

**Step 2: Make backup.sh executable**

```bash
chmod +x deploy/scripts/backup.sh
```

**Step 3: Verify required-variable guard works**

```bash
bash deploy/scripts/backup.sh 2>&1 || true
```

Expected output includes: `CLIENT_NAME is required`

**Step 4: Commit**

```bash
git add deploy/scripts/backup.sh
git commit -m "feat: add backup.sh for pg_dump to Azure Blob Storage"
```

---

### Task 5: RUNBOOK.md

**Files:**
- Create: `deploy/RUNBOOK.md`

**Step 1: Create RUNBOOK.md**

```markdown
# Breedbase T3 Deployment Runbook

This runbook covers standing up a new Breedbase instance on an Azure VM.
Run each step in order. Do not skip steps.

**Prerequisites:**
- Azure VM provisioned (B2ms, Ubuntu 22.04 LTS) — see infra/ for Terraform
- DNS A record pointing `{{CLIENT_HOSTNAME}}` to the VM's public IP
- SSH access to the VM

---

## 1. Initial VM setup

```bash
# Update packages
sudo apt-get update && sudo apt-get upgrade -y

# Install Docker
curl -fsSL https://get.docker.com | sudo sh
sudo usermod -aG docker $USER
newgrp docker

# Install Docker Compose plugin
sudo apt-get install -y docker-compose-plugin

# Install nginx and certbot
sudo apt-get install -y nginx certbot python3-certbot-nginx

# Install Azure CLI
curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash

# Log in to Azure (managed identity — no interactive login needed if VM has identity assigned)
az login --identity
```

---

## 2. Clone T3 Breedbase

```bash
cd /opt
sudo git clone https://github.com/TriticeaeToolbox/breedbase
sudo chown -R $USER:$USER breedbase
cd breedbase
```

---

## 3. Clone this repo (tiller)

```bash
cd /opt
git clone https://github.com/countercheck/tiller
```

---

## 4. Set client variables

Create a file `/etc/breedbase-client.env` (not committed to git):

```bash
sudo tee /etc/breedbase-client.env > /dev/null <<EOF
CLIENT_HOSTNAME=edmonton.ourplatform.ca
CLIENT_NAME=edmonton
DB_PASSWORD=$(openssl rand -base64 24 | tr -d /+=)
PROGRAM_NAME=AB_Barley
CONTACT_EMAIL=admin@ourplatform.ca
AZURE_STORAGE_ACCOUNT=tillerbackups
AZURE_CONTAINER=edmonton-backups
EOF
sudo chmod 600 /etc/breedbase-client.env
```

Source the file:
```bash
source /etc/breedbase-client.env
```

---

## 5. Configure nginx

```bash
# Substitute placeholders
bash /opt/tiller/deploy/scripts/configure.sh \
    /opt/tiller/deploy/nginx/breedbase.conf.template \
    /etc/nginx/sites-available/breedbase

# Enable the site
sudo ln -s /etc/nginx/sites-available/breedbase /etc/nginx/sites-enabled/breedbase
sudo rm -f /etc/nginx/sites-enabled/default

# Test nginx config
sudo nginx -t

# Reload nginx
sudo systemctl reload nginx
```

---

## 6. Configure Breedbase (sgn_local.conf)

```bash
# Substitute placeholders
bash /opt/tiller/deploy/scripts/configure.sh \
    /opt/tiller/deploy/breedbase/sgn_local.conf.template \
    /opt/breedbase/config/hordeum.conf
```

---

## 7. Run Breedbase setup

```bash
cd /opt/breedbase

# First-time setup: pulls Docker images (several GB — takes 10-20 minutes)
./bin/breedbase setup

# When prompted for the database password, use $DB_PASSWORD from step 4
```

---

## 8. Obtain SSL certificate

```bash
# Certbot will update the nginx config automatically
sudo certbot --nginx -d $CLIENT_HOSTNAME --non-interactive --agree-tos -m $CONTACT_EMAIL
```

---

## 9. Start Breedbase

```bash
cd /opt/breedbase
./bin/breedbase start

# Breedbase web container takes 3-5 minutes to finish starting — this is normal
# Check status:
./bin/breedbase status

# Check logs if needed:
./bin/breedbase log hordeum
```

---

## 10. Install backup cron

```bash
# Copy backup script
sudo cp /opt/tiller/deploy/scripts/backup.sh /usr/local/bin/breedbase-backup
sudo chmod +x /usr/local/bin/breedbase-backup

# Install cron job (runs every Sunday at 02:00)
(crontab -l 2>/dev/null; echo "0 2 * * 0 source /etc/breedbase-client.env && /usr/local/bin/breedbase-backup >> /var/log/breedbase-backup.log 2>&1") | crontab -
```

---

## 11. Smoke test checklist

- [ ] `https://{{CLIENT_HOSTNAME}}` loads the Breedbase homepage
- [ ] SSL certificate is valid (no browser warning)
- [ ] Login with the admin account created during `breedbase setup`
- [ ] Create a test germplasm entry and verify it saves
- [ ] Run backup manually and verify blob appears in Azure Storage:
  ```bash
  source /etc/breedbase-client.env && /usr/local/bin/breedbase-backup
  az storage blob list --account-name $AZURE_STORAGE_ACCOUNT \
      --container-name $AZURE_CONTAINER --auth-mode login --output table
  ```
- [ ] Confirm `./bin/breedbase status` shows all containers running

---

## Maintenance

**Start/stop:**
```bash
cd /opt/breedbase
./bin/breedbase start
./bin/breedbase stop
```

**Update Breedbase:**
```bash
cd /opt/breedbase
./bin/breedbase update
```

**View logs:**
```bash
./bin/breedbase log hordeum
```

**Re-run configure.sh after template changes:**
```bash
source /etc/breedbase-client.env
bash /opt/tiller/deploy/scripts/configure.sh \
    /opt/tiller/deploy/breedbase/sgn_local.conf.template \
    /opt/breedbase/config/hordeum.conf
./bin/breedbase stop && ./bin/breedbase start
```
```

**Step 2: Commit**

```bash
git add deploy/RUNBOOK.md
git commit -m "docs: add Breedbase T3 deployment runbook"
```

---

### Task 6: Update deploy/README.md

**Files:**
- Modify: `deploy/README.md`

**Step 1: Replace contents**

```markdown
# deploy

Deployment artefacts for the Breedbase T3 stack on Azure.

Contains everything needed to stand up a new client instance after the VM is
provisioned. See `infra/` for Terraform templates that create the VM itself.

## Contents

- `nginx/breedbase.conf.template` — nginx server block with SSL and proxy_pass to Breedbase
- `breedbase/sgn_local.conf.template` — Breedbase application config (barley/hordeum instance)
- `scripts/configure.sh` — substitutes `{{PLACEHOLDER}}` values in templates
- `scripts/backup.sh` — pg_dump to Azure Blob Storage (install as weekly cron job)
- `RUNBOOK.md` — step-by-step deployment guide: bare VM → running Breedbase

## Deployment

See [RUNBOOK.md](RUNBOOK.md) for the full procedure.

Quick summary:
1. Provision VM with Terraform (infra/)
2. Set DNS A record
3. Run steps in RUNBOOK.md in order

## Placeholders

All templates use `{{PLACEHOLDER}}` syntax. configure.sh reads these from environment
variables and performs substitution via sed.

| Placeholder | Description |
|---|---|
| `{{CLIENT_HOSTNAME}}` | Public hostname, e.g. `edmonton.ourplatform.ca` |
| `{{CLIENT_NAME}}` | Short client identifier, e.g. `edmonton` |
| `{{DB_PASSWORD}}` | PostgreSQL password for `web_usr` (generate at deploy time) |
| `{{PROGRAM_NAME}}` | Breedbase program name, e.g. `AB_Barley` |
| `{{CONTACT_EMAIL}}` | Admin contact address |
| `{{AZURE_STORAGE_ACCOUNT}}` | Azure storage account for backups |
| `{{AZURE_CONTAINER}}` | Azure blob container for backups |

## Tests

```bash
bash deploy/scripts/tests/test_configure.sh
```
```

**Step 2: Commit**

```bash
git add deploy/README.md
git commit -m "docs: update deploy/README with actual contents and placeholder table"
```

---

### Task 7: Verify and push

**Step 1: Run tests one final time**

```bash
bash deploy/scripts/tests/test_configure.sh
```

Expected: `Results: 9 passed, 0 failed`

**Step 2: Check tree**

```bash
find deploy/ -not -path '*/.git/*' | sort
```

Expected:
```
deploy/
deploy/RUNBOOK.md
deploy/README.md
deploy/breedbase/
deploy/breedbase/sgn_local.conf.template
deploy/nginx/
deploy/nginx/breedbase.conf.template
deploy/scripts/
deploy/scripts/backup.sh
deploy/scripts/configure.sh
deploy/scripts/tests/
deploy/scripts/tests/test_configure.sh
```

**Step 3: Check git log**

```bash
git log --oneline
```

Expected: 7 feature commits on top of the scaffold commits.

**Step 4: Push feature branch**

```bash
git push -u origin feature/deploy
```
